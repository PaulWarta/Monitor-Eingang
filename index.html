<!DOCTYPE html>
<html lang="us">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.gstatic.com"> 
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <title>Document</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.gstatic.com"> 
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@700;900&display=swap" rel="stylesheet">
    <script src="https://code.iconify.design/1/1.0.6/iconify.min.js"></script>
</head>
<body>
    <svg width="1080" height="1778" viewBox="0 0 1080 1778" fill="none" xmlns="http://www.w3.org/2000/svg">
        <g filter="url(#filter0_f)">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M643.148 734.922C643.233 822.344 487.134 910.368 439.017 1007.15C361.036 1164 482.908 1346.1 288.781 1447.69C102.95 1544.94 38.4718 1350.65 -64.1796 1270.49C-128.572 1220.2 -190.835 1169.53 -180.462 1081.24C-169.606 988.848 -101.56 891.911 -8.9286 800.244C123.808 668.891 267.012 485.921 438.491 468.743C610.402 451.521 643.022 607.007 643.148 734.922Z" fill="#BC29C8" fill-opacity="0.79"/>
        </g>
        <defs>
            <filter id="filter0_f" x="-723" y="0" width="2032.11" height="1967.32" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
                <feFlood flood-opacity="0" result="BackgroundImageFix"/>
                <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/>
                <feGaussianBlur stdDeviation="196.5" result="effect1_foregroundBlur"/>
            </filter>
        </defs>
    </svg>
    <div class="Uhrzeit">
        <h1 id="Uhrzeit"></h1>
    </div>
    <div class="Wetter">
        <h1 id="Temperature"></h1>
        <span class="iconify" data-inline="false" data-icon="" id="icon"></span>
    </div>
    <div class="Navigation">
        <h2>Schön, <br> dass Ihr <br> wieder da seid!</h2>
    </div>
    <div id="Stundenplan">
    </div>
    <div class="News">
        <h3>
            Wenn ihr wollt, könnt Ihr <br> euch gerne hier <br> zusätzlich anmelden:
        </h3>
        <img src="Luca_QR_plain1.png" id="Luca">
        <img src="./Warnapp_QR_plain1.png" id="Warnapp">
    </div>
    <div class="Poster"></div>
    <script>
        setInterval(
            function req_time() {
            var time = new Date;
            if (time.getMinutes().toString() < 10) {
                element = document.getElementById("Uhrzeit").innerText = time.getHours().toString() + ":0" + time.getMinutes().toString();
            } else {
                element = document.getElementById("Uhrzeit").innerText = time.getHours().toString() + ":" + time.getMinutes().toString();
            }
        }, 1000);
    </script>
    <script defer>
        const icon_library = {
            "01d" : "sunny",
            "01n" : "moon",
            "02d" : "partly-cloudy-day",
            "02n" : "partly-cloudy-night",
            "03d" : "cloudy",
            "03n" : "cloudy",
            "04d" : "cloudy",
            "04n" : "cloudy",
            "09d" : "rain",
            "09n" : "rain",
            "10d" : "rain-showers-day",
            "10n" : "rain-showers-night",
            "11d" : "thunderstorm",
            "11n" : "thunderstorm",
            "13d" : "snow",
            "13n" : "snow",
            "50d" : "fog",
            "50n" : "fog"
        }
        function fetch_weather () {
            var xhttp = new XMLHttpRequest;
            xhttp.open("GET", "http://api.openweathermap.org/data/2.5/weather?q=muelheim&units=metric&appid=2e9c5036920dde9cf253e5f1581328c2", false);
            xhttp.send();
            let data = JSON.parse(xhttp.responseText);
            let ic = data.weather;
            ic = ic[0];
            ic = ic.icon;
            let url = "fluent:weather-" + icon_library[ic] + "-48-regular"
            let temp = data.main;
            temp = temp.temp;
            document.getElementById("icon").setAttribute("data-icon", url);
            document.getElementById("Temperature").innerText = Math.round(temp.toString()).toString() + "\xB0";
        }
        setInterval(fetch_weather(), 60000)
        fetch_weather();
    </script>
    <script defer>
        let xhttp = new XMLHttpRequest;
        xhttp.open("GET", "timetable.txt", false);
        xhttp.send();
        let response = xhttp.responseText;
        let data = JSON.parse(response);
        let len = Object.keys(data).length;
        for (i = 0; i < len; i++) {
            j = (i - (len - 1)) * -1;
            console.log(j);
            let start = data[j]["start"];
            let end = data[j]["end"];
            let name = data[j]["name"];
            let teacher = data[j]["teacher"];
            let room = data[j]["room"];
            let place_of_image = "./images/" + "Luca" + ".png";

            let Stundenplan = document.getElementById("Stundenplan");
            let Std_container = document.createElement("div")
            Std_container.setAttribute("class", "StdContainer");

            let DescContainer = document.createElement("div"); DescContainer.setAttribute("class", "DescContainer");
            let teacher_image = document.createElement("img"); teacher_image.setAttribute("src", place_of_image); teacher_image.setAttribute("class", "Profilbild"); 
            Std_container.appendChild(teacher_image);
            let kurs_element = document.createElement("h4"); kurs_element.innerText = name; DescContainer.appendChild(kurs_element);
            let kurs_description = document.createElement("h5"); kurs_description.innerText = room + " - " + teacher; DescContainer.appendChild(kurs_description);
            Std_container.appendChild(DescContainer); 
            Stundenplan.appendChild(Std_container);
        }
    </script>
</body>
</html>